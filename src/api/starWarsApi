import { APICharacter, Character } from '../interfaces/interfaces';
import { API_URL } from '../config/api.ts';

export const fetchCharacters = async (searchTerm = ''): Promise<Character[]> => {
  try {
    const url = searchTerm ? `${API_URL}?search=${encodeURIComponent(searchTerm)}` : API_URL;
    const response = await fetch(url);

    if (!response.ok) {
      throw new Error('Failed to fetch characters');
    }

    const data: { results: APICharacter[] } = await response.json();

    return data.results.map((char: APICharacter) => ({
      id: char.url,
      name: char.name,
      description: char.birth_year || 'No description available',
    }));
  } catch (error) {
    throw new Error('Failed to fetch characters');
  }
};

